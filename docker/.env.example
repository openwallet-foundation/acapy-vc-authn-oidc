############################################
# Global / Logging
############################################
COMPOSE_PROJECT_NAME=vc-authn
LOG_LEVEL=DEBUG
LOG_WITH_JSON=false
DEBUGGER=false
NGROK_AUTHTOKEN=your-ngrok-authtoken

############################################
# Controller Database (Mongo)
############################################
MONGODB_HOST=controller-db
MONGODB_PORT=27017
MONGODB_NAME=oidccontroller
# Must match mongo/mongo-init.js
OIDC_CONTROLLER_DB_USER=oidccontrolleruser
OIDC_CONTROLLER_DB_USER_PWD=oidccontrollerpass


############################################
# OIDC Controller Service
############################################
CONTROLLER_SERVICE_PORT=5000

# Public URLs
# Set automatically by manage script from ngrok for local dev
# CONTROLLER_URL=https://your-public-url.example.com
# Internal Docker network URL for aca-py to reach controller (nginx listens on 80)
CONTROLLER_WEB_HOOK_URL=http://controller-lb/webhooks
CONTROLLER_API_KEY=

# Controller Behavior
CONTROLLER_CAMERA_REDIRECT_URL=wallet_howto
CONTROLLER_PRESENTATION_EXPIRE_TIME=300
CONTROLLER_PRESENTATION_CLEANUP_TIME=86400
CONTROLLER_PRESENTATION_RECORD_RETENTION_HOURS=1
CONTROLLER_CLEANUP_MAX_PRESENTATION_RECORDS=1000
CONTROLLER_CLEANUP_MAX_CONNECTIONS=2000

# Configuration Files & Paths
CONTROLLER_SESSION_TIMEOUT_CONFIG_FILE=/app/controller-config/sessiontimeout.json
CONTROLLER_VARIABLE_SUBSTITUTION_OVERRIDE=/app/controller-config/user_variable_substitution.py
CONTROLLER_TEMPLATE_DIR=/app/controller-config/templates
   
# Verification Options
# NOTE: WebVH plugin requires ACAPY_PROOF_FORMAT=anoncreds and ACAPY_WALLET_TYPE=askar-anoncreds
INVITATION_LABEL="VC-AuthN"
SET_NON_REVOKED=true
ACAPY_PROOF_FORMAT=anoncreds
ACAPY_WALLET_TYPE=askar-anoncreds
USE_OOB_LOCAL_DID_SERVICE=true
USE_CONNECTION_BASED_VERIFICATION=true
USE_URL_DEEP_LINK=false
WALLET_DEEP_LINK_PREFIX=bcwallet://aries_proof-request

# Scaling & Caching
CONTROLLER_REPLICAS=3

# Redis Configuration for multi-pod Socket.IO
# REDIS_MODE options: none, single, sentinel, cluster
#   none     - Redis disabled (single-pod only)
#   single   - Single Redis instance
#   sentinel - Redis Sentinel (high availability)
#   cluster  - Redis Cluster (horizontal scaling)
REDIS_MODE=single
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0

# Sentinel mode example:
# REDIS_MODE=sentinel
# REDIS_HOST=sentinel1:26379,sentinel2:26379,sentinel3:26379
# REDIS_SENTINEL_MASTER_NAME=mymaster

# Cluster mode example:
# REDIS_MODE=cluster
# REDIS_HOST=redis-node1:6379,redis-node2:6379,redis-node3:6379

# Legacy (deprecated, use REDIS_MODE=single instead):
# USE_REDIS_ADAPTER=true


############################################
# ACA-Py Agent
############################################
AGENT_HOST=aca-py
AGENT_NAME="VC-AuthN Agent"

AGENT_HTTP_PORT=8030
AGENT_ADMIN_PORT=8077

# ACA-Py admin endpoint - use Docker container name for local single-tenant mode
AGENT_ADMIN_URL=http://aca-py:8077

# Agent public endpoint - leave commented for local dev (manage script sets from ngrok)
# AGENT_ENDPOINT=https://your-agent-endpoint.example.com

AGENT_ADMIN_API_KEY=changeme
AGENT_GENESIS_URL=https://test.bcovrin.vonx.io/genesis
# Must be exactly 32 characters
AGENT_WALLET_SEED=vc-authn-oidc-dev-seed-000000000


########################################################
# ACA-Py Wallet / Tenant Identity
#
# When AGENT_TENANT_MODE=multi:
#   ACAPY_TENANT_WALLET_ID  = Wallet ID
#   ACAPY_TENANT_WALLET_KEY = Wallet Key
#
# When AGENT_TENANT_MODE=traction:
#   ACAPY_TENANT_WALLET_ID  = Traction Tenant ID
#   ACAPY_TENANT_WALLET_KEY = Traction Tenant API Key
########################################################
# Use 'single' for local dev, 'traction' or 'multi' for hosted agents
AGENT_TENANT_MODE=single

# Only needed for multi/traction modes
# ACAPY_TENANT_WALLET_ID=your-tenant-id-here
# ACAPY_TENANT_WALLET_KEY=your-tenant-key-here

# Cache TTL for tenant tokens in seconds (default: 3600)
ACAPY_TOKEN_CACHE_TTL=3600

# Legacy (used when AGENT_TENANT_MODE=single)
MT_ACAPY_WALLET_ID=legacy-wallet-id
MT_ACAPY_WALLET_KEY=legacy-wallet-key


##########################################################
# ACA-Py Single-Tenant Settings (AGENT_TENANT_MODE=single)
##########################################################
# Must match AGENT_ADMIN_API_KEY for single-tenant mode
ST_ACAPY_ADMIN_API_KEY_NAME=x-api-key
ST_ACAPY_ADMIN_API_KEY=changeme


##############################
# Wallet Database (PostgreSQL)
##############################
WALLET_TYPE=postgres_storage
WALLET_ENCRYPTION_KEY=key
POSTGRESQL_WALLET_HOST=wallet-db
POSTGRESQL_WALLET_PORT=5432
POSTGRESQL_WALLET_DATABASE=wallet_db
POSTGRESQL_WALLET_USER=walletuser
POSTGRESQL_WALLET_PASSWORD=walletpassword


############################################
# OIDC Client
############################################
OIDC_CLIENT_ID=keycloak
OIDC_CLIENT_NAME="Keycloak (local)"
OIDC_CLIENT_REDIRECT_URI=http://localhost:8880/auth/realms/vc-authn/broker/vc-authn/endpoint
OIDC_CLIENT_SECRET=**********

# OIDC UserInfo / Compatibility Settings
# Enable the /userinfo endpoint (Required for Firebase).
# Defaults to false to preserve architectural intent (ephemeral state).
CONTROLLER_ENABLE_USERINFO_ENDPOINT=false

# Duration in seconds for Access Token validity (Default: 3600).
# In Redis mode, this also synchronizes the data retention period.
OIDC_ACCESS_TOKEN_TTL=3600


############################################
# Keycloak Database
############################################
KEYCLOAK_DB_NAME=keycloak
KEYCLOAK_DB_USER=keycloak
KEYCLOAK_DB_PASSWORD=change-me


############################################
# Keycloak Service
############################################
KEYCLOAK_DB_VENDOR=postgres
KEYCLOAK_DB_ADDR=keycloak-db
KEYCLOAK_USER=admin
KEYCLOAK_PASSWORD=admin
KEYCLOAK_LOGLEVEL=WARN
KEYCLOAK_ROOT_LOGLEVEL=WARN
